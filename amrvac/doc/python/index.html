<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.9.1"/>
<title>AMRVAC Python tools: Main Page</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="vaclogo.gif"/></td>
  <td style="padding-left: 0.5em;">
   <div id="projectname">AMRVAC Python tools
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.9.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li class="current"><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AMRVAC Python tools Documentation</div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#Installation">Installation</a><ul><li class="level2"><a href="#distribution">Python distribution</a></li>
<li class="level2"><a href="#AMRVAC-Tools">AMRVAC-Tools</a></li>
</ul>
</li>
<li class="level1"><a href="#reading">Reading data</a><ul><li class="level2"><a href="#vtu">vtu and pvtu files</a></li>
<li class="level2"><a href="#vti">vti files</a></li>
<li class="level2"><a href="#particles">Particle dat files</a></li>
<li class="level2"><a href="#ensemble">Particle csv files</a></li>
<li class="level2"><a href="#slice">Slice csv files</a></li>
</ul>
</li>
<li class="level1"><a href="#plotting">Plotting data</a><ul><li class="level2"><a href="#onedplots">1D plotting</a></li>
<li class="level2"><a href="#twodplots">2D plotting</a><ul><li class="level3"><a href="#convenience">Auxiliary functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#doc">Making this documentation</a></li>
</ul>
</div>
<div class="textblock"><p>This document describes the use of Python for plotting MPI-AMRVAC 1D and 2D simulation data. <em>The Python tools were initiated by Oliver Porth.</em></p>
<p>The Python macros are located in the directory <code>tools/python</code> and depend on <a href="http://www.vtk.org">VTK</a>-bindings and the widespread <a href="http://www.scipy.org/">SciPy</a> toolkit.</p>
<h1><a class="anchor" id="Installation"></a>
Installation</h1>
<h2><a class="anchor" id="distribution"></a>
Python distribution</h2>
<p>If you are a beginner at Python, we recommend using a pre-configured python-distribution such as <a href="https://store.enthought.com/#canopy-academic">Enthought Canopy</a>. Note that for VTK support you will need to sign up for the free academic version. This distribution comes with <a href="http://www.scipy.org/">SciPy</a> which bundles essential numerical tools (<a href="http://www.numpy.org/">numpy</a>), a plotting backend (<a href="http://matplotlib.org/">matplotlib</a>) and a command-line interface called <a href="http://ipython.org/">IPython</a> for interactive use.</p>
<p>You can verify your VTK installation by trying to <code>import vtk</code> in a Python session. If VTK is installed properly, this should throw no error messages.</p>
<h2><a class="anchor" id="AMRVAC-Tools"></a>
AMRVAC-Tools</h2>
<p>The tools are installed by adding the directory <code>$AMRVAC_DIR/tools/python</code> to your python path. This can be done in a number of ways. Either you expand your <code>$PYTHONPATH</code> environment variable, e.g. on the bash shell:</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;export PYTHONPATH = $AMRVAC_DIR/tools/python:$PYTHONPATH</div>
</div><!-- fragment --><p>or you add a file <em>userpath.pth</em> in one of the folders existing in the search path already. The file simply contains</p>
<div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;youramrvacdir/tools/python</div>
</div><!-- fragment --><p>where <em>youramrvacdir</em> has to be the resolved variable <code>$AMRVAC_DIR</code>, e.g. <code>/Users/Max/code/amrvac</code>. For example on a mac, you can add the userpath.pth to the directory <code>/Library/Frameworks/Python.framework/Versions/Current/lib/python2.7/site-packages</code> or similar.</p>
<h1><a class="anchor" id="reading"></a>
Reading data</h1>
<p>We currently support reading the <b>cell-centered</b> VTK file-types <code>.vtu, .pvtu, .vti</code> as well as binary particle <code>.dat</code> files and some ascii <code>.csv</code> files for Python. This means that you can use the same files with e.g. Paraview or Visit. These can be created in parallel and during runtime (see also the section on data-file <a href="../convert.html">conversion</a>). Reading data is handled in the file ready.py which provides various classes for different data.</p>
<p>For interactive use with the terminal, cd to the directory containing your data and fire up ipython: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;ipython --pylab</div>
</div><!-- fragment --><p> Import the reader and plotter classes: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; import read,amrplot</div>
</div><!-- fragment --> <h2><a class="anchor" id="vtu"></a>
vtu and pvtu files</h2>
<p>This uses the class <a class="el" href="classread_1_1load.html">read.load</a>.</p>
<p>Interactively load the data: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d=read.load(offset,file=&#39;data&#39;,type=&#39;vtu&#39;)  </div>
</div><!-- fragment --><p> which loads data'offset'.vtu, where offset is zero-padded to four digits (e.g. 0010). The data is contained in the instance <code>d</code>. Thus <code>d.rho</code> holds the numpy-array of the density, <code>d.v1</code> hols the first component of velocity (assuming your data is in primitive quantities and your velocity variable is called '<code>v1</code>') and so on. To load a different snapshot into the instance <code>e</code>, type </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; e=read.load(DifferentOffset,file=&#39;data&#39;,type=&#39;vtu&#39;) </div>
</div><!-- fragment --><p> In order to load a file ending in <code>.pvtu</code>, change the attribute of the optional parameter type to <code>type='pvtu'</code>. The default is currently <code>type='vtu'</code>.</p>
<h2><a class="anchor" id="vti"></a>
vti files</h2>
<p>This uses the class <a class="el" href="classread_1_1loadvti.html">read.loadvti</a>. For uniform <code>.vti</code> files, you can use </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d=read.loadvti(offset,file=&#39;data&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="particles"></a>
Particle dat files</h2>
<p>This uses the class <a class="el" href="classread_1_1particles.html">read.particles</a>. Type </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d=read.particles(offset,file=&#39;data&#39;)</div>
</div><!-- fragment --><p> to import the particle snapshot data into python.</p>
<h2><a class="anchor" id="ensemble"></a>
Particle csv files</h2>
<p>This uses the class <a class="el" href="classread_1_1ensemble.html">read.ensemble</a> to load particle ensemble comma separated value files. Type </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d=read.ensemble(offset, file=&#39;data0000&#39;, npayload=1)</div>
</div><!-- fragment --><p> to load file <code>data0000_ensemble</code><em>offset</em><code>.csv</code> where <em>offset</em> is zero padded to six digits. <code>npayload</code> stands for the number of payload arrays in your data (default is one). We have two running indices in the output files, where the first <code>data0000</code> describes the fluid snapshot (e.g. useful when adding particles to a frozen snaphot) and the second <code>offset</code> denotes the particle ensemble snapshot number.</p>
<h2><a class="anchor" id="slice"></a>
Slice csv files</h2>
<p>To load a 1D slice in <code>.csv</code> format from a 2D simulation, you can use the class <a class="el" href="classread_1_1loadcsv.html">read.loadcsv</a> </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d=read.loadcsv(offset,get=1,file=&#39;data&#39;,dir=1,coord=0.)</div>
</div><!-- fragment --><p> which loads file <code>data_d</code><em>dir</em><code>_x</code><em>coord</em>_n<em>offset</em><code>.csv</code>, e.g. <code>data_d1_x+0.00D00_n0000.csv</code>.</p>
<h1><a class="anchor" id="plotting"></a>
Plotting data</h1>
<h2><a class="anchor" id="onedplots"></a>
1D plotting</h2>
<p>Once the data is loaded into the instance <code>d</code>, you can access it with <code>d.varname</code> where <code>varname</code> is a variable name chosen in your AMRVAC parameter-file. Pythons powerful introspectrion makes it real easy to see whats available in the data: just type <code>d.</code> and hit the <em>tab</em> key to see whats available. For uniform data (<code>.vti</code>), the arithmetic center of the cells can be obtained via the command </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; d.getCenterPoints()</div>
</div><!-- fragment --><p> see <a class="el" href="classread_1_1load.html#abd18004cdc081e7244548387dc7f6b4c">read.load.getCenterPoints</a> for implemetation details. Thus you can make a simple 1D plot using matplotlib </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; plot(d.getCenterPoints(),d.rho,&#39;k-+&#39;)</div>
</div><!-- fragment --><p> in solid ('<code>-</code>') black ('<code>k</code>') with '<code>+</code>' symbols. At this point <code>d.getCenterPoints()</code> and <code>d.rho</code> are simply numpy arrays so you can use all of <a href="http://matplotlib.org/contents.html">matplotlib</a> for your plotting experience.</p>
<p>For the structured <code>.vti</code> files, the attribute <a class="el" href="classread_1_1loadvti.html#ad8a6fdb88386dce051cdade16bf426a1">read.loadvti.x</a> (or .y or .z) denotes the cell center coordinate, such that a plot would be obtained with </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; plot(d.x,d.rho,&#39;k-+&#39;)</div>
</div><!-- fragment --><h2><a class="anchor" id="twodplots"></a>
2D plotting</h2>
<p>The module <a class="el" href="namespaceamrplot.html">amrplot</a> contains plotting tools for 2D AMR data. These come in two flavours: the class <a class="el" href="classamrplot_1_1polyplot.html">amrplot.polyplot</a> to show each cell in one patch and the class <a class="el" href="classamrplot_1_1rgplot.html">amrplot.rgplot</a> to show data interpolated onto a uniform mesh. Other than that, both classes offer the same functionality. To display a 2D image of the density in your datastructure <code>d</code>, invoke a new instance </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; p1=amrplot.polyplot(d.rho,d)</div>
</div><!-- fragment --><p> which opens a new window containing your data. Drawing a window for the first time might take a few seconds as a list of the cell patches has to be generated. You can re-plot another quantity (e.g. temperature ~p/rho) in this window with the command </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; p1.show(d.p/d.rho,d)</div>
</div><!-- fragment --><p> <a class="el" href="classamrplot_1_1polyplot.html">amrplot.polyplot</a> has several convenient members, for example you can save your image to a file using <a class="el" href="classamrplot_1_1polyplot.html#a384d903da0e996388d66ba1702b8c69a">amrplot.polyplot.save</a> which takes the filename as a parameter. The AMR blocks can be displayed by setting the attribute </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;&gt;&gt;&gt; p1.blocks=1</div>
</div><!-- fragment --><p> which can be switched off by setting <a class="el" href="classamrplot_1_1polyplot.html#a81c5cd47348d2861c881942d2999d193">amrplot.polyplot.blocks</a> back to <code>None</code>. You can fix the axis-range with the attributes <a class="el" href="classamrplot_1_1polyplot.html#ab2e85991ae46edf094b98591597e6f87">amrplot.polyplot.xrange</a> and <a class="el" href="classamrplot_1_1polyplot.html#ac8b059832edba2155f81adde51acecd5">amrplot.polyplot.yrange</a> and fix the window zoom by setting <a class="el" href="classamrplot_1_1polyplot.html#aa4653b545c07e2a4ed7f0f61bf45e85f">amrplot.polyplot.fixzoom</a> to a value other than <code>None</code>.</p>
<p>The method <a class="el" href="classamrplot_1_1polyplot.html#af40653c737fcd78dc956ac51a5a2ac9a">amrplot.polyplot.onkey</a> allows you to inspect a location in your data: use the middle mouse button to mark a cell in your plotting window, then a pink crosshair will be displayed and the flow variables at chosen location are returned to the terminal.</p>
<h3><a class="anchor" id="convenience"></a>
Auxiliary functions</h3>
<p>Some auxiliary functions you might find useful:</p><ul>
<li><a class="el" href="classamrplot_1_1line.html">amrplot.line</a> selects flow variables over a straight path across your 2D slice</li>
<li><a class="el" href="namespaceamrplot.html#ac900799ef23a01f0ec851965aaa9b938">amrplot.velovect</a> provides "velocity vectors" for a flow field</li>
<li><a class="el" href="namespaceamrplot.html#a490436be04747e3d099f8733676029c4">amrplot.contour</a> overlays contours onto your plotting window</li>
<li><a class="el" href="namespaceamrplot.html#a6b04b21d5ecd2b6776d0c2981d5298ba">amrplot.streamlines</a> shows streamlines of a vector field</li>
<li><a class="el" href="namespaceamrplot.html#a24f7f7c37b5a64e33272bd2fb4c49b95">amrplot.streamline</a> plots a single streamline with given starting value</li>
</ul>
<h1><a class="anchor" id="doc"></a>
Making this documentation</h1>
<p>This documentation is created using <a href="https://github.com/Feneric/doxypypy">doxypypy</a> and the documentation system <a href="http:www.doxygen.org">Doxygen</a>. Simply run </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;./makedoc</div>
</div><!-- fragment --><p> in the <code>$AMRVAC_DIR/tools/python</code> folder to re-generate the documentation. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Mar 1 2015 20:26:22 for AMRVAC Python tools by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.9.1
</small></address>
</body>
</html>
